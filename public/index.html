<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>DAVANTTI • Shopee API</title>
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <!-- Topbar (fina) -->
    <header class="ml-topbar">
      <div class="ml-topbar__left">
        <div class="brand">
          <img class="logo" src="https://res.cloudinary.com/dhqxp3tuo/image/upload/v1766582391/image_15740736993eche52h2_njlgfu.png" alt="Shopee" />
          <div class="brand-text">
            <div class="title">DAVANTTI</div>
            <div class="subtitle">Open Shopee • Integração</div>
          </div>
        </div>
      </div>

      <div class="ml-topbar__right">
        <div class="header-pill">
          <span class="dot"></span>
          <span id="auth-status">Dashboard pronto. Use as abas para ver dados.</span>
        </div>
      </div>
    </header>

    <!-- App layout (sidebar + main) -->
    <div class="ml-app">
      <aside class="ml-sidebar">
        <div class="ml-sidebar__section">
          <div class="ml-sidebar__title">Menu</div>

          <!-- IMPORTANTE: mantive class="tab" e data-tab para seu initTabs() -->
          <button class="tab ml-nav-item active" data-tab="auth">
            <span class="ml-nav-item__label">Autenticação</span>
            <span class="ml-nav-item__hint muted">Token / status</span>
          </button>

          <button class="tab ml-nav-item" data-tab="products">
            <span class="ml-nav-item__label">Produtos</span>
            <span class="ml-nav-item__hint muted">Catálogo / variações</span>
          </button>

          <button class="tab ml-nav-item" data-tab="orders">
            <span class="ml-nav-item__label">Pedidos</span>
            <span class="ml-nav-item__hint muted">Risco / snapshots</span>
          </button>
        </div>

        <div class="ml-sidebar__section">
          <div class="ml-sidebar__title">Atalhos</div>
          <div class="ml-sidebar__mini muted">
            Layout inspirado no Mercado Livre. Mantém rotas, IDs e lógica atual.
          </div>
        </div>
      </aside>

      <main class="ml-main container">
        <!-- AUTH -->
        <section id="tab-auth" class="tab-panel active">
          <div class="page-title">
            <h2>Autenticação</h2>
            <div class="page-subtitle muted">Controle de acesso e status da integração.</div>
          </div>

          <div class="section-card">
            <div class="section-card__header">
              <div>
                <div class="section-title">Status</div>
                <div class="muted">Visualize o estado atual da integração.</div>
              </div>
            </div>
            <div class="section-card__body">
              <div class="info-row">
                <div class="info-label">Status</div>
                <div class="info-value" id="auth-status-view">Ainda não configurado</div>
              </div>
            </div>
          </div>

          <div class="section-card">
            <div class="section-card__header">
              <div>
                <div class="section-title">Ações</div>
                <div class="muted">Gere o link e finalize a autorização.</div>
              </div>
              <div class="section-actions">
                <button id="btn-auth-url" class="btn btn-primary">Gerar link de autorização</button>
              </div>
            </div>
            <div class="section-card__body">
              <div id="auth-url-preview" class="muted" style="word-break:break-all;"></div>
            </div>
          </div>
        </section>

        <!-- PRODUCTS -->
        <section id="tab-products" class="tab-panel">
          <div class="page-title">
            <h2>Produtos</h2>
            <div class="page-subtitle muted">Sincronização sob demanda, listagem e detalhes.</div>
          </div>

          <div class="section-grid">
            <div class="section-card">
              <div class="section-card__header">
                <div>
                  <div class="section-title">Sincronização</div>
                  <div class="muted">Sincroniza apenas quando solicitado (sob demanda).</div>
                </div>
                <div class="section-actions">
                  <button id="btn-sync-products" class="btn btn-primary">Sincronizar Produtos</button>
                </div>
              </div>
              <div class="section-card__body">
                <div id="products-sync-status" class="muted"></div>
              </div>
            </div>

            <div class="section-card">
              <div class="section-card__header">
                <div>
                  <div class="section-title">Visualização</div>
                  <div class="muted">Filtros, ordenação e busca.</div>
                </div>
              </div>
              <div class="section-card__body">
                <div class="toolbar">
                  <div class="toolbar__left">
                    <label class="muted">Por página:</label>
                    <select id="products-page-size" class="select">
                      <option value="25">25</option>
                      <option value="50" selected>50</option>
                      <option value="100">100</option>
                    </select>

                    <label class="muted">Ordenar por:</label>
                    <select id="products-sort-by" class="select">
                      <option value="updatedAt">Atualização</option>
                      <option value="createdAt">Criação</option>
                      <option value="sold">Vendas</option>
                    </select>

                    <select id="products-sort-dir" class="select">
                      <option value="desc" selected>↓ (maior → menor / mais recente)</option>
                      <option value="asc">↑ (menor → maior / mais antigo)</option>
                    </select>
                  </div>

                  <div class="toolbar__right">
                    <input id="products-q" class="input" placeholder="Buscar por ID, SKU ou Nome..." />
                    <button id="products-search" class="btn">Buscar</button>
                    <button id="products-clear" class="btn btn-ghost">Limpar</button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div id="products-grid" class="grid"></div>

          <div class="section-card products-pagination">
            <div class="section-card__body">
              <div class="toolbar toolbar--between">
                <div id="products-page-info" class="muted"></div>
                <div class="products-pager-actions">
                  <button id="products-first" class="btn btn-ghost">Primeira</button>
                  <button id="products-prev" class="btn btn-ghost">Anterior</button>
                  <button id="products-next" class="btn btn-ghost">Próxima</button>
                  <button id="products-last" class="btn btn-ghost">Última</button>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- ORDERS -->
        <section id="tab-orders" class="tab-panel">
          <div class="page-title">
            <h2>Pedidos</h2>
            <div class="page-subtitle muted">Sincronize e consulte pedidos armazenados no banco.</div>
          </div>

          <div class="section-card">
            <div class="section-card__header">
              <div>
                <div class="section-title">Alertas</div>
                <div class="muted">Troca de endereço e risco de atraso.</div>
              </div>
              <div class="section-actions">
                <button id="btn-sync-orders" class="btn btn-primary">Sincronizar Pedidos</button>
              </div>
            </div>
            <div class="section-card__body">
              <div id="orders-sync-status" class="muted"></div>
            </div>
          </div>

          <div id="orders-grid" class="grid"></div>
        </section>
      </main>
    </div>

    <!-- Modal (IDs mantidos) -->
    <div id="modal-overlay" class="modal-overlay" style="display:none;">
      <div class="modal">
        <div class="modal-header">
          <div id="modal-title" class="modal-title">Detalhes</div>
          <button id="modal-close" class="modal-close">Fechar</button>
        </div>
        <div id="modal-body" class="modal-body"></div>
      </div>
    </div>

    <script src="/app.js"></script>
    <script>
      // espelha o status do header no card de Autenticação
      const headerStatus = document.getElementById("auth-status");
      const viewStatus = document.getElementById("auth-status-view");
      if (headerStatus && viewStatus) viewStatus.textContent = headerStatus.textContent;
    </script>
  </body>
</html>